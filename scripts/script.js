// ==================== –î–ê–ù–ù–´–ï –ü–†–û–ï–ö–¢–û–í ====================

const projectsData = {
    0: {
        title: "–õ–∏—á–Ω—ã–π —Å–∞–π—Ç",
        category: "HTML, CSS",
        description: "–ú–æ–π –ø–µ—Ä–≤—ã–π –≤–µ–±-–ø—Ä–æ–µ–∫—Ç ‚Äî –ª–∏—á–Ω–∞—è –≤–∏–∑–∏—Ç–Ω–∞—è –∫–∞—Ä—Ç–æ—á–∫–∞",
        fullDescription: "–í —ç—Ç–æ–º –ø—Ä–æ–µ–∫—Ç–µ —è –ø—Ä–∏–º–µ–Ω–∏–ª –Ω–∞–≤—ã–∫–∏ HTML5 –∏ CSS3, —Å–æ–∑–¥–∞–≤ –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–π –¥–∏–∑–∞–π–Ω, –∫–æ—Ç–æ—Ä—ã–π —Ö–æ—Ä–æ—à–æ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –Ω–∞ –≤—Å–µ—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ç–µ—Ö–Ω–∏–∫–∏ –≤–µ—Ä—Å—Ç–∫–∏ —Å Flexbox –∏ Grid.",
        technologies: ["HTML5", "CSS3", "Flexbox", "CSS Grid"],
        github: "https://github.com/sablin1412",
        demo: "file:///C:/Users/MSI/OneDrive/Desktop/frontend-and-backend-practice/index.html",
        image: "../images/ww1.jpg"
    },
    1: {
        title: "Todo-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ",
        category: "JavaScript",
        description: "–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –¥–∞–Ω–Ω—ã—Ö",
        fullDescription: "–°–æ–∑–¥–∞–Ω–æ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –≤–∞–Ω–∏–ª—å–Ω–æ–≥–æ JavaScript. –í—Å–µ –∑–∞–¥–∞—á–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ localStorage –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –º–µ–∂–¥—É —Å–µ–∞–Ω—Å–∞–º–∏. –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã —Ñ—É–Ω–∫—Ü–∏–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è, —É–¥–∞–ª–µ–Ω–∏—è –∏ –æ—Ç–º–µ—Ç–∫–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö –∑–∞–¥–∞—á.",
        technologies: ["JavaScript", "HTML5", "CSS3", "LocalStorage"],
        github: "https://github.com/sablin1412",
        demo: "https://jakesgordon.com/games/racer/",
        image: "../images/ww2.jpg"
    },
    2: {
        title: "–ò–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω",
        category: "React",
        description: "–°–∞–π—Ç —Å –∫–æ—Ä–∑–∏–Ω–æ–π –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π —Ç–æ–≤–∞—Ä–æ–≤",
        fullDescription: "–ü–æ—Å—Ç—Ä–æ–µ–Ω–æ –Ω–∞ React —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–Ω–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞. E-commerce –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å –ø–æ–ª–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å—é: –∫–∞—Ç–∞–ª–æ–≥ —Ç–æ–≤–∞—Ä–æ–≤, –∫–æ—Ä–∑–∏–Ω–∞ –ø–æ–∫—É–ø–æ–∫, —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∏ –ø–æ–∏—Å–∫. –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–∞ —Ä–∞–±–æ—Ç–∞ —Å API –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤.",
        technologies: ["React", "JavaScript", "CSS3", "API"],
        github: "https://github.com/sablin1412",
        demo: "file:///C:/Users/MSI/OneDrive/Desktop/frontend-and-backend-practice/pages/goods.html",
        image: "../images/ww3.jpg"
    },
    3: {
        title: "–ü–æ—Ä—Ç—Ñ–æ–ª–∏–æ Bootstrap",
        category: "Bootstrap, CSS",
        description: "–ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π —à–∞–±–ª–æ–Ω –ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∞ Bootstrap",
        fullDescription: "–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω Bootstrap –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ —Å–æ–∑–¥–∞–Ω–∏—è –∞–¥–∞–ø—Ç–∏–≤–Ω–æ–≥–æ –º–∞–∫–µ—Ç–∞. –î–∏–∑–∞–π–Ω –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω –¥–ª—è –≤—Å–µ—Ö —Ä–∞–∑–º–µ—Ä–æ–≤ —ç–∫—Ä–∞–Ω–æ–≤ —Å –∫—Ä–∞—Å–∏–≤—ã–º —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º.",
        technologies: ["Bootstrap", "CSS3", "Responsive Design"],
        github: "https://github.com/sablin1412",
        demo: "https://yandex.ru/games/app/272081",
        image: "../images/ww4.jpg"
    },
    4: {
        title: "–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä",
        category: "JavaScript, HTML, CSS",
        description: "–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –≤–µ–±-–∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä —Å –∏—Å—Ç–æ—Ä–∏–µ–π –æ–ø–µ—Ä–∞—Ü–∏–π",
        fullDescription: "–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≤—Å–µ –æ—Å–Ω–æ–≤–Ω—ã–µ –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏, –∏–º–µ–µ—Ç –æ—á–µ–Ω—å —É–¥–æ–±–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∏ –∏—Å—Ç–æ—Ä–∏—é —Ä–∞—Å—á–µ—Ç–æ–≤ —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö –≤—ã—á–∏—Å–ª–µ–Ω–∏–π.",
        technologies: ["JavaScript", "HTML5", "CSS3"],
        github: "https://github.com/sablin1412",
        demo: "https://www.desmos.com/scientific?lang=ru",
        image: "../images/ww5.jpg"
    },
    5: {
        title: "–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ü–æ–≥–æ–¥–∞",
        category: "React, API",
        description: "–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –ø–æ–≥–æ–¥—ã —Å –¥–∞–Ω–Ω—ã–º–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏",
        fullDescription: "–ò—Å–ø–æ–ª—å–∑—É–µ—Ç React –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º –∏ –≤–Ω–µ—à–Ω–µ–µ API OpenWeatherMap –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∞–∫—Ç—É–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –æ –ø–æ–≥–æ–¥–µ. –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–æ–≥–Ω–æ–∑ –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ –¥–Ω–µ–π —Å –¥–µ—Ç–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π.",
        technologies: ["React", "API", "JavaScript", "CSS3"],
        github: "https://github.com/sablin1412",
        demo: "https://www.windy.com/ru/-%D0%A0%D0%B0%D0%B4%D0%B0%D1%80-%D0%BF%D0%BE%D0%B3%D0%BE%D0%B4%D1%8B-radar?radar,",
        image: "../images/ww6.jpg"
    }
};

// ==================== –§–ò–õ–¨–¢–†–ê–¶–ò–Ø –ü–†–û–ï–ö–¢–û–í (–¥–ª—è projects.html) ====================

document.addEventListener('DOMContentLoaded', function() {
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ –∫–Ω–æ–ø–∫–∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ
    const filterBtns = document.querySelectorAll('.filter-btn');
    
    if (filterBtns.length > 0) {
        const projectCards = document.querySelectorAll('[data-category]');
        
        filterBtns.forEach(btn => {
            btn.addEventListener('click', function() {
                // –£–¥–∞–ª–∏—Ç—å –∫–ª–∞—Å—Å active —Å–æ –≤—Å–µ—Ö –∫–Ω–æ–ø–æ–∫
                filterBtns.forEach(b => b.classList.remove('active'));
                
                // –î–æ–±–∞–≤–∏—Ç—å –∫–ª–∞—Å—Å active —Ç–µ–∫—É—â–µ–π –∫–Ω–æ–ø–∫–µ
                this.classList.add('active');
                
                const filterValue = this.getAttribute('data-filter');
                
                projectCards.forEach(card => {
                    if (filterValue === 'all') {
                        card.style.display = 'block';
                        setTimeout(() => {
                            card.style.opacity = '1';
                        }, 10);
                    } else {
                        if (card.getAttribute('data-category') === filterValue) {
                            card.style.display = 'block';
                            setTimeout(() => {
                                card.style.opacity = '1';
                            }, 10);
                        } else {
                            card.style.display = 'none';
                        }
                    }
                });
            });
        });
    }
});

// ==================== –ú–û–î–ê–õ–¨–ù–´–ï –û–ö–ù–ê ====================

document.addEventListener('DOMContentLoaded', function() {
    const modal = document.getElementById('projectModal');
    
    if (!modal) return; // –ï—Å–ª–∏ –º–æ–¥–∞–ª–∫–∏ –Ω–µ—Ç –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ, –≤—ã—Ö–æ–¥–∏–º
    
    const detailButtons = document.querySelectorAll('.project-details-btn');
    const closeButtons = document.querySelectorAll('[data-close-modal]');

    // –û—Ç–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
    detailButtons.forEach(btn => {
        btn.addEventListener('click', function() {
            const projectId = this.getAttribute('data-project');
            const project = projectsData[projectId];
            
            if (project) {
                openModal(project);
            }
        });
    });

    // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
    closeButtons.forEach(btn => {
        btn.addEventListener('click', closeModal);
    });

    // –ó–∞–∫—Ä—ã—Ç–∏–µ –ø–æ Escape
    document.addEventListener('keydown', function(e) {
        if (e.key === 'Escape' && !modal.hasAttribute('hidden')) {
            closeModal();
        }
    });

    function openModal(project) {
        const modalTitle = modal.querySelector('.modal__title');
        const modalBody = modal.querySelector('.modal__body');

        modalTitle.textContent = project.title;
        
        modalBody.innerHTML = `
            <img src="${project.image}" alt="${project.title}" style="width: 100%; border-radius: 0.5rem; margin-bottom: 1rem;">
            <p style="margin-bottom: 1rem; line-height: 1.7;"><strong>–ö–∞—Ç–µ–≥–æ—Ä–∏—è:</strong> ${project.category}</p>
            <p style="margin-bottom: 1rem; line-height: 1.7;">${project.fullDescription}</p>
            <h3 style="margin-bottom: 0.5rem; color: var(--primary-color);">–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏:</h3>
            <div style="display: flex; gap: 0.5rem; flex-wrap: wrap; margin-bottom: 1rem;">
                ${project.technologies.map(tech => `<span class="tag">${tech}</span>`).join('')}
            </div>
            <div style="display: flex; gap: 1rem; margin-top: 1.5rem; flex-wrap: wrap;">
                <a href="${project.github}" target="_blank" rel="noopener noreferrer" class="button button--primary">GitHub</a>
                <a href="${project.demo}" target="_blank" rel="noopener noreferrer" class="button button--secondary">–î–µ–º–æ</a>
            </div>
        `;

        modal.removeAttribute('hidden');
        modal.setAttribute('aria-hidden', 'false');
        
        // –§–æ–∫—É—Å –Ω–∞ –∑–∞–≥–æ–ª–æ–≤–æ–∫ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
        modalTitle.focus();
        
        // –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø—Ä–æ–∫—Ä—É—Ç–∫–∏ body
        document.body.style.overflow = 'hidden';
    }

    function closeModal() {
        modal.setAttribute('hidden', '');
        modal.setAttribute('aria-hidden', 'true');
        document.body.style.overflow = '';
    }
});

// ==================== –ü–ï–†–ï–ö–õ–Æ–ß–ê–¢–ï–õ–¨ –¢–ï–ú–´ ====================

document.addEventListener('DOMContentLoaded', function() {
    const themeToggle = document.getElementById('themeToggle');
    const themeIcon = themeToggle?.querySelector('.theme-icon');
    
    if (!themeToggle) return;

    // –ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω–æ–π —Ç–µ–º—ã
    const savedTheme = localStorage.getItem('theme') || 'light';
    applyTheme(savedTheme);

    themeToggle.addEventListener('click', function() {
        const currentTheme = document.documentElement.getAttribute('data-theme') || 'light';
        const newTheme = currentTheme === 'light' ? 'dark' : 'light';
        applyTheme(newTheme);
        localStorage.setItem('theme', newTheme);
    });

    function applyTheme(theme) {
        document.documentElement.setAttribute('data-theme', theme);
        if (themeIcon) {
            themeIcon.textContent = theme === 'light' ? 'üåô' : '‚òÄÔ∏è';
        }
        themeToggle.setAttribute('aria-label', theme === 'light' ? '–í–∫–ª—é—á–∏—Ç—å —Ç—ë–º–Ω—É—é —Ç–µ–º—É' : '–í–∫–ª—é—á–∏—Ç—å —Å–≤–µ—Ç–ª—É—é —Ç–µ–º—É');
    }
});

// ==================== –ê–ö–¢–ò–í–ù–ê–Ø –°–°–´–õ–ö–ê –í –ù–ê–í–ò–ì–ê–¶–ò–ò ====================

document.addEventListener('DOMContentLoaded', function() {
    const currentPage = window.location.pathname.split('/').pop() || 'index.html';
    const navLinks = document.querySelectorAll('.nav__link');

    navLinks.forEach(link => {
        const linkPage = link.getAttribute('href');
        if (linkPage === currentPage) {
            link.classList.add('active');
        }
    });
});

// ==================== –í–ê–õ–ò–î–ê–¶–ò–Ø –§–û–†–ú–´ –ö–û–ù–¢–ê–ö–¢–û–í (–¥–ª—è contacts.html) ====================

document.addEventListener('DOMContentLoaded', function() {
    const contactForm = document.getElementById('contactForm');
    
    if (!contactForm) return; // –ï—Å–ª–∏ —Ñ–æ—Ä–º—ã –Ω–µ—Ç, –≤—ã—Ö–æ–¥–∏–º
    
    contactForm.addEventListener('submit', function(e) {
        e.preventDefault();
        
        const name = document.getElementById('name');
        const email = document.getElementById('email');
        const message = document.getElementById('message');
        
        let isValid = true;
        
        // –û—á–∏—Å—Ç–∫–∞ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö –æ—à–∏–±–æ–∫
        document.querySelectorAll('.error-message').forEach(el => el.remove());
        document.querySelectorAll('.input-error').forEach(el => el.classList.remove('input-error'));
        
        // –í–∞–ª–∏–¥–∞—Ü–∏—è –∏–º–µ–Ω–∏
        if (name.value.trim().length < 2) {
            showError(name, '–ò–º—è –¥–æ–ª–∂–Ω–æ —Å–æ–¥–µ—Ä–∂–∞—Ç—å –º–∏–Ω–∏–º—É–º 2 —Å–∏–º–≤–æ–ª–∞');
            isValid = false;
        }
        
        // –í–∞–ª–∏–¥–∞—Ü–∏—è email
        const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        if (!emailRegex.test(email.value.trim())) {
            showError(email, '–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π email');
            isValid = false;
        }
        
        // –í–∞–ª–∏–¥–∞—Ü–∏—è —Å–æ–æ–±—â–µ–Ω–∏—è
        if (message.value.trim().length < 10) {
            showError(message, '–°–æ–æ–±—â–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ —Å–æ–¥–µ—Ä–∂–∞—Ç—å –º–∏–Ω–∏–º—É–º 10 —Å–∏–º–≤–æ–ª–æ–≤');
            isValid = false;
        }
        
        if (isValid) {
            // –ó–¥–µ—Å—å –º–æ–∂–Ω–æ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä
            alert('–°–ø–∞—Å–∏–±–æ –∑–∞ —Å–æ–æ–±—â–µ–Ω–∏–µ! –Ø —Å–≤—è–∂—É—Å—å —Å –≤–∞–º–∏ –≤ –±–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è.');
            contactForm.reset();
        }
    });
    
    function showError(input, message) {
        input.classList.add('input-error');
        const errorDiv = document.createElement('div');
        errorDiv.className = 'error-message';
        errorDiv.style.color = 'var(--danger-color)';
        errorDiv.style.fontSize = '0.875rem';
        errorDiv.style.marginTop = '0.25rem';
        errorDiv.textContent = message;
        input.parentElement.appendChild(errorDiv);
    }
});

/// ==================== –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û –î–ù–ï–í–ù–ò–ö–ê –° LOCALSTORAGE ====================

document.addEventListener('DOMContentLoaded', function() {
    const addEntryBtn = document.getElementById('addEntryBtn');
    const addEntryModal = document.getElementById('addEntryModal');
    const addEntryForm = document.getElementById('addEntryForm');
    const closeButtons = document.querySelectorAll('[data-close-modal-diary]');
    const progressInput = document.getElementById('entryProgress');
    const progressValue = document.getElementById('progressValue');
    const entriesList = document.querySelector('.diary-entries');

    if (!addEntryBtn || !addEntryModal) return;

    // –ó–∞–≥—Ä—É–∑–∫–∞ –∑–∞–ø–∏—Å–µ–π –∏–∑ localStorage –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
    loadDiaryEntries();

    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
    if (progressInput && progressValue) {
        progressInput.addEventListener('input', function() {
            progressValue.textContent = this.value + '%';
        });
    }

    // –û—Ç–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
    addEntryBtn.addEventListener('click', function() {
        openDiaryModal();
    });

    // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
    closeButtons.forEach(btn => {
        btn.addEventListener('click', closeDiaryModal);
    });

    // –ó–∞–∫—Ä—ã—Ç–∏–µ –ø–æ Escape
    document.addEventListener('keydown', function(e) {
        if (e.key === 'Escape' && !addEntryModal.hasAttribute('hidden')) {
            closeDiaryModal();
        }
    });

    // –û—Ç–ø—Ä–∞–≤–∫–∞ —Ñ–æ—Ä–º—ã
    if (addEntryForm) {
        addEntryForm.addEventListener('submit', function(e) {
            e.preventDefault();
            
            // –û—á–∏—Å—Ç–∫–∞ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö –æ—à–∏–±–æ–∫
            document.querySelectorAll('.error-message').forEach(el => el.remove());
            document.querySelectorAll('.input-error').forEach(el => el.classList.remove('input-error'));
            
            const title = document.getElementById('entryTitle');
            const description = document.getElementById('entryDescription');
            const progress = document.getElementById('entryProgress');
            const status = document.querySelector('input[name="entryStatus"]:checked');
            
            let isValid = true;
            
            // –í–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞–∑–≤–∞–Ω–∏—è
            if (title.value.trim().length < 3) {
                showError(title, '–ù–∞–∑–≤–∞–Ω–∏–µ –¥–æ–ª–∂–Ω–æ —Å–æ–¥–µ—Ä–∂–∞—Ç—å –º–∏–Ω–∏–º—É–º 3 —Å–∏–º–≤–æ–ª–∞');
                isValid = false;
            }
            
            // –í–∞–ª–∏–¥–∞—Ü–∏—è –æ–ø–∏—Å–∞–Ω–∏—è
            if (description.value.trim().length < 10) {
                showError(description, '–û–ø–∏—Å–∞–Ω–∏–µ –¥–æ–ª–∂–Ω–æ —Å–æ–¥–µ—Ä–∂–∞—Ç—å –º–∏–Ω–∏–º—É–º 10 —Å–∏–º–≤–æ–ª–æ–≤');
                isValid = false;
            }
            
            if (isValid) {
                const entryData = {
                    id: Date.now(), // —É–Ω–∏–∫–∞–ª—å–Ω—ã–π ID
                    title: title.value.trim(),
                    description: description.value.trim(),
                    progress: parseInt(progress.value),
                    status: status.value,
                    date: new Date().toISOString()
                };
                
                // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ localStorage
                saveDiaryEntry(entryData);
                
                // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É
                addDiaryEntryToPage(entryData);
                
                // –°–±—Ä–æ—Å —Ñ–æ—Ä–º—ã
                addEntryForm.reset();
                progressValue.textContent = '50%';
                
                // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
                closeDiaryModal();
                
                // –ü–æ–∫–∞–∑–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
                showNotification('‚úì –ó–∞–ø–∏—Å—å —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–∞!');
            }
        });
    }

    // ========== –§–£–ù–ö–¶–ò–ò LOCALSTORAGE ==========

    function saveDiaryEntry(entryData) {
        // –ü–æ–ª—É—á–∞–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –∑–∞–ø–∏—Å–∏
        let entries = JSON.parse(localStorage.getItem('diaryEntries')) || [];
        
        // –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å –≤ –Ω–∞—á–∞–ª–æ –º–∞—Å—Å–∏–≤–∞
        entries.unshift(entryData);
        
        // –°–æ—Ö—Ä–∞–Ω—è–µ–º –æ–±—Ä–∞—Ç–Ω–æ –≤ localStorage
        localStorage.setItem('diaryEntries', JSON.stringify(entries));
    }

    function loadDiaryEntries() {
        if (!entriesList) return;
        
        // –ü–æ–ª—É—á–∞–µ–º –∑–∞–ø–∏—Å–∏ –∏–∑ localStorage
        let entries = JSON.parse(localStorage.getItem('diaryEntries')) || [];
        
        // –î–æ–±–∞–≤–ª—è–µ–º –∫–∞–∂–¥—É—é –∑–∞–ø–∏—Å—å –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É
        entries.forEach(entry => {
            addDiaryEntryToPage(entry, false); // false = –±–µ–∑ –∞–Ω–∏–º–∞—Ü–∏–∏ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        });
    }

    function deleteDiaryEntry(id) {
        // –ü–æ–ª—É—á–∞–µ–º –∑–∞–ø–∏—Å–∏
        let entries = JSON.parse(localStorage.getItem('diaryEntries')) || [];
        
        // –§–∏–ª—å—Ç—Ä—É–µ–º, —É–¥–∞–ª—è—è –∑–∞–ø–∏—Å—å —Å –Ω—É–∂–Ω—ã–º id
        entries = entries.filter(entry => entry.id !== id);
        
        // –°–æ—Ö—Ä–∞–Ω—è–µ–º –æ–±–Ω–æ–≤–ª—ë–Ω–Ω—ã–π –º–∞—Å—Å–∏–≤
        localStorage.setItem('diaryEntries', JSON.stringify(entries));
    }

    // ========== –§–£–ù–ö–¶–ò–ò –ò–ù–¢–ï–†–§–ï–ô–°–ê ==========

    function openDiaryModal() {
        addEntryModal.removeAttribute('hidden');
        addEntryModal.setAttribute('aria-hidden', 'false');
        document.body.style.overflow = 'hidden';
        
        // –§–æ–∫—É—Å –Ω–∞ –ø–µ—Ä–≤–æ–µ –ø–æ–ª–µ
        const firstInput = addEntryModal.querySelector('input, textarea');
        if (firstInput) {
            setTimeout(() => firstInput.focus(), 100);
        }
    }

    function closeDiaryModal() {
        addEntryModal.setAttribute('hidden', '');
        addEntryModal.setAttribute('aria-hidden', 'true');
        document.body.style.overflow = '';
        
        // –û—á–∏—Å—Ç–∫–∞ –æ—à–∏–±–æ–∫
        document.querySelectorAll('.error-message').forEach(el => el.remove());
        document.querySelectorAll('.input-error').forEach(el => el.classList.remove('input-error'));
    }

    function showError(input, message) {
        input.classList.add('input-error');
        const errorDiv = document.createElement('div');
        errorDiv.className = 'error-message';
        errorDiv.textContent = message;
        input.parentElement.appendChild(errorDiv);
    }

    function addDiaryEntryToPage(data, animate = true) {
        const newEntry = document.createElement('article');
        newEntry.className = animate ? 'diary-entry diary-entry--new' : 'diary-entry';
        newEntry.setAttribute('data-entry-id', data.id);
        
        const statusClass = data.status === 'completed' ? 'status--completed' : 'status--progress';
        const statusText = data.status === 'completed' ? '‚úì –ó–∞–≤–µ—Ä—à–µ–Ω–æ' : '‚è≥ –í –ø—Ä–æ—Ü–µ—Å—Å–µ';
        
        // –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞—Ç—ã
        const entryDate = new Date(data.date);
        const formattedDate = entryDate.toLocaleDateString('ru-RU', { 
            day: 'numeric', 
            month: 'long', 
            year: 'numeric' 
        });
        
        newEntry.innerHTML = `
            <div class="diary-entry__header">
                <h3 class="diary-entry__title">${escapeHtml(data.title)}</h3>
                <div class="diary-entry__actions">
                    <span class="diary-entry__status ${statusClass}">${statusText}</span>
                    <button class="delete-entry-btn" data-id="${data.id}" aria-label="–£–¥–∞–ª–∏—Ç—å –∑–∞–ø–∏—Å—å" title="–£–¥–∞–ª–∏—Ç—å –∑–∞–ø–∏—Å—å">
                        üóëÔ∏è
                    </button>
                </div>
            </div>
            <p class="diary-entry__date">${formattedDate}</p>
            <p class="diary-entry__description">${escapeHtml(data.description)}</p>
            <div class="diary-entry__progress">
                <div class="progress-bar">
                    <div class="progress-bar__fill" style="--progress: ${data.progress}%;" role="progressbar" aria-valuenow="${data.progress}" aria-valuemin="0" aria-valuemax="100"></div>
                </div>
            </div>
        `;
        
        // –î–æ–±–∞–≤–ª—è–µ–º –≤ –Ω–∞—á–∞–ª–æ —Å–ø–∏—Å–∫–∞
        entriesList.prepend(newEntry);
        
        // –ê–Ω–∏–º–∞—Ü–∏—è –ø–æ—è–≤–ª–µ–Ω–∏—è (—Ç–æ–ª—å–∫–æ –¥–ª—è –Ω–æ–≤—ã—Ö –∑–∞–ø–∏—Å–µ–π)
        if (animate) {
            setTimeout(() => {
                newEntry.classList.add('diary-entry--show');
            }, 10);
        }
        
        // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ —É–¥–∞–ª–µ–Ω–∏—è
        const deleteBtn = newEntry.querySelector('.delete-entry-btn');
        deleteBtn.addEventListener('click', function() {
            const entryId = parseInt(this.getAttribute('data-id'));
            
            if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç—É –∑–∞–ø–∏—Å—å?')) {
                // –£–¥–∞–ª—è–µ–º –∏–∑ localStorage
                deleteDiaryEntry(entryId);
                
                // –£–¥–∞–ª—è–µ–º —Å–æ —Å—Ç—Ä–∞–Ω–∏—Ü—ã —Å –∞–Ω–∏–º–∞—Ü–∏–µ–π
                newEntry.style.opacity = '0';
                newEntry.style.transform = 'translateX(-20px)';
                setTimeout(() => {
                    newEntry.remove();
                    showNotification('üóëÔ∏è –ó–∞–ø–∏—Å—å —É–¥–∞–ª–µ–Ω–∞');
                }, 300);
            }
        });
    }

    function showNotification(message) {
        const notification = document.createElement('div');
        notification.className = 'notification';
        notification.textContent = message;
        document.body.appendChild(notification);
        
        setTimeout(() => {
            notification.classList.add('notification--show');
        }, 10);
        
        setTimeout(() => {
            notification.classList.remove('notification--show');
            setTimeout(() => {
                notification.remove();
            }, 300);
        }, 3000);
    }

    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è HTML (–∑–∞—â–∏—Ç–∞ –æ—Ç XSS)
    function escapeHtml(text) {
        const div = document.createElement('div');
        div.textContent = text;
        return div.innerHTML;
    }
});
